# Using Volumes in Docker

## Mounting Volumes

- **Using a Volume**:
  - Command:
    ```bash
    docker run -p 8000:80 -v $(PWD)/logs:/var/www/logs <image_name>
    ```
  - **Explanation**:
    - `-p 8000:80`: Maps port 8000 on the host to port 80 in the container.
    - `-v $(PWD)/logs:/var/www/logs`: Mounts the `logs` directory from the current host path to `/var/www/logs` in the container.
    - `$(PWD)`: Retrieves the current directory path, which works on macOS and Linux; use `${PWD}` on Windows PowerShell.

> **Note**: Mounting volumes helps in persisting data beyond the container’s lifecycle and provides access to logs or data generated by the application in the container.

---

# Docker Networking

## Creating a Bridge Network

Docker provides different network types (e.g., bridge, host, overlay). The bridge network is the default network type used for container-to-container communication on the same host.

- **List Available Networks**:
  - Command:
    ```bash
    docker network ls
    ```
  - **Explanation**: Lists all networks available, including the default bridge network.

- **Creating a Custom Bridge Network**:
  - Command:
    ```bash
    docker network create --driver bridge isolated-network
    ```
  - **Explanation**:
    - `--driver bridge`: Specifies the network driver type as bridge.
    - `isolated-network`: The custom network name.

- **Removing a Network**:
  - Command:
    ```bash
    docker network rm <network_name>
    ```
  - Removes the specified network by name.

---

## Running Containers on a Custom Network

- **Running Containers on an Isolated Network**:
  - Run MongoDB container:
    ```bash
    docker run -d --net=isolated-network --name mongodb mongo
    ```
  - Run a Node.js application container:
    ```bash
    docker run -d -p 3000:3000 --net=isolated-network --name nodeapp <node_image_name>
    ```
  - **Explanation**:
    - `--net=isolated-network`: Connects the container to the `isolated-network`.
    - `--name`: Assigns a name to the container for easier reference.
    - Containers on the same network can communicate using container names (e.g., the `nodeapp` container can reach `mongodb` by simply using its name).

- **Inspecting a Network**:
  - Command:
    ```bash
    docker network inspect isolated-network
    ```
  - **Explanation**: Displays details about the specified network, including connected containers and their IP addresses.

---

## Shell Access into a Running Container

- **Using exec to Access Shell**:
  - Command:
    ```bash
    docker exec -it <container_id> sh
    ```
  - **Explanation**:
    - `-it`: Interactive mode with TTY support.
    - `sh`: Opens a shell session in the specified container.
    - Useful for troubleshooting and inspecting the container’s file system and environment.

---

# Building and Running Multiple Containers with Docker Compose

Docker Compose is a tool for defining and running multi-container Docker applications using a `docker-compose.yml` file.

## Basic Docker Compose Commands

- **Define Services in YAML**:
  - Create a `docker-compose.yml` file to define multiple services:
    ```yaml
    version: '3'
    services:
      web:
        image: nginx
        ports:
          - "8080:80"
      app:
        build: .
        volumes:
          - ./app:/app
        networks:
          - isolated-network
      db:
        image: mongo
        networks:
          - isolated-network
    networks:
      isolated-network:
        driver: bridge
    ```
  - **Explanation**:
    - `version`: Specifies the version of the Compose file format.
    - `services`: Defines the containers.
      - **web**: Runs an Nginx container on port 8080.
      - **app**: Builds from a Dockerfile in the current directory and mounts a volume.
      - **db**: Runs a MongoDB container.
    - `networks`: Creates an isolated network for communication between containers.

- **Building Images**:
  - Command:
    ```bash
    docker-compose build
    ```
  - **Explanation**: Builds images for all services defined in `docker-compose.yml`.

- **Starting Services**:
  - Command:
    ```bash
    docker-compose up
    ```
  - **Explanation**:
    - Starts all services defined in the Compose file.
    - Runs containers in the foreground. Use `-d` to run in detached mode.

- **Stopping and Removing Containers**:
  - Command:
    ```bash
    docker-compose down
    ```
  - **Explanation**: Stops and removes all containers, networks, and volumes created by `docker-compose up`.

---

## Additional Docker Compose Tips

- **Viewing Logs for All Services**:
  - Command:
    ```bash
    docker-compose logs -f
    ```
  - **Explanation**: Streams the logs of all running services, making it easier to monitor and debug.

- **Scaling Services**:
  - Command:
    ```bash
    docker-compose up --scale <service_name>=<count>
    ```
  - **Example**:
    ```bash
    docker-compose up --scale app=3
    ```
  - **Explanation**:
    - `--scale`: Allows scaling a specific service to multiple instances, useful for load balancing and high availability.
    - Starts three instances of the `app` service.

> **Note**: Docker Compose simplifies managing multi-container applications, providing a single command to start, stop, and manage all containers and services defined in a `docker-compose.yml` file.

